# Architecture of Bunsan

本来Webは、サーバの境界を超えてドキュメント間に自由にリンクを張るものであり、
一方ブラウザからはそれらを各人が自由なルートで利用できる、
実質的に単一のドキュメントネットワークを構成している。

Bunsanでは、プログラムに対して、
Webのような、単一のネットワークのうえで
提供者と利用者の双方で自由につながる関係を可能とするための
根幹のアーキテクチャを選択したものである。

Bunsanにおける「プログラム」とは、
URIを通じて非同期に他の「プログラム」へとアクセスできる存在である。
この「プログラム」のために、あるURIでアクセスした「プログラム」から受け取った
「ドキュメント」の中にあるハイパーリンクのURIを通じて、
別のプログラムを次々と呼び出すことで相互作用しあうための仕組みが必要である。
Bunsanでは、サーバ側ではなく、ブラウザにおけるWeb技術にもとづいて、
その発展技術となるように、この仕組みを達成する技術を提供する。

そして、これらの「プログラム」の非同期実行のエントリーポイントのために、
Bunsanではユニバーサルな「イベント」のネットワークhashnetを提唱する。
hashnetは、イベント発行者やイベントキューのような特定の対象に制約されずに、
単一の"hashnet"に対してイベントをPub Subするモデルを採る。

ここでの「プログラム」は、"hashnetに対して"「イベント」をPUTし、
"hashnetから"「イベント」をGETするアーキテクチャとなるものである。
「イベント」をGETする側では、その「イベント」の内容にもとづいて、
非同期で処理を行うことから、
イベントをPUTする「プログラム」とイベントをGETする「プログラム」の間は、
「イベント」の内容を表明する情報「context」に対して、シェアしあう関係となる。

このhashnetは、インターネット上で、それぞれに「イベント」キューを
もった「ピア」の分散的な連携によって実現する。
まず、ピア単体のみでの単一「イベント」キューとして、hashnetはそのピア局所的で成立する。
その上で、ピア間で連携するための各種の情報を入れたhashnet上の「イベント」を
発行し解釈するhashnet上のシステムとして、
ピア間での分散連携も実現する構成となっている。
たとえばネットワーク上のピアが新たなピアを追加したとき、
そのピア追加をイベントとしてhashnetでシェアすることで、
ネットワーク上のピアはそれぞれその新ピアに対しての適切な扱いをすることで
ネットワークシステムとして機能する。
同様の手法で、hashnet上のシステムとして、パッケージ配布システムなどでも、
hashnet上の分散システムとして自己拡張していくことができる。

この「イベント」は非対称鍵により署名検証され、
検証の公開鍵は「イベント」発行者のアイデンティティと一対一対応するため、
「イベント」の内容は発行者によるものとして信頼する、ことになる。
その「イベント」の内容として埋め込まれたURIもその発行者による保証されたものであり、
「イベント」の内容とURIの先にある情報とを突き合わせによって、
URIの先への信頼を機械的に表明できるものとなる。
たとえば、イベントシーケンスは、「前のイベント」のURIを含むイベント内容によって、その順序は保証されることになる。
イベント署名者の間を横断するリンク関係を考えると、
これは個々のイベント発行者を起点とした、URIへの信頼の連鎖の仕組みを提供するものである。
「新しいピアをネットワークに追加する」といった、
hashnetにおけるピアの連携とは、この信頼の連鎖を広げていくことで成立させるものとなる。






